{"version":3,"file":"react-intercom.umd.js","sources":["../src/intercomAPI.ts","../src/react-intercom.ts"],"sourcesContent":["export default function(method: string, ...args: Array<any>) {\n  if (window.Intercom) {\n    window.Intercom.apply(null, [method, args]);\n  } else {\n    console.warn('Intercom not initialized yet');\n  }\n}\n","import React, { useEffect, useRef } from 'react';\nimport IntercomAPI from './intercomAPI';\n\ninterface IntercomSettings {\n  app_id: string;\n  [x: string]: string;\n}\n\ndeclare global {\n  interface Window {\n    Intercom: (...args: Array<any>) => any;\n    intercomSettings: IntercomSettings;\n    attachEvent?: any;\n  }\n}\n\ninterface ReactIntercomAvatar {\n  type: string;\n  image_url: string;\n}\n\ninterface ReactIntercomCompany {\n  company_id: string;\n  created_at?: string;\n  name?: string;\n  monthy_spend?: Number;\n  plan?: string;\n  size?: Number;\n  website?: string;\n  industry?: string;\n}\n\ninterface ReactIntercomDataAttributes {\n  email?: string;\n  user_id?: string;\n  created_at?: string;\n  name?: string;\n  phone?: string;\n  last_request_at?: void; // reserved, can't be updated\n  unsubscribed_from_emails?: boolean;\n  language_override?: string;\n  utm_campaign?: string;\n  utm_content?: string;\n  utm_medium?: string;\n  utm_source?: string;\n  utm_term?: string;\n  avatar?: ReactIntercomAvatar;\n  user_hash?: string;\n  company?: ReactIntercomCompany;\n  companies?: ReactIntercomCompany[];\n  [custom_property: string]: any;\n}\n\ninterface ReactIntercomProps extends ReactIntercomDataAttributes {\n  app_id: string;\n  alignment?: string;\n  horizontal_padding?: Number;\n  vertical_padding?: Number;\n  custom_launcher_selector?: string;\n  hide_default_launcher?: string;\n  session_duration?: string;\n  action_color?: string;\n  background_color?: string;\n}\n\nfunction ReactIntercom<T extends ReactIntercomProps>(props: T) {\n  // Keep intercomSettings in sync\n  window.intercomSettings = props;\n  IntercomAPI('update');\n\n  // Iinitialization\n  useEffect(() => {\n    if (!props.app_id) {\n      return;\n    }\n    (function() {\n      var w = window;\n      var ic = w.Intercom;\n      if (typeof ic === 'function') {\n        ic('reattach_activator');\n        ic('update', w.intercomSettings);\n      } else {\n        var d = document;\n        var i: any = function() {\n          i.c(arguments);\n        };\n        i.q = [];\n        i.c = function(args: any) {\n          i.q.push(args);\n        };\n        w.Intercom = i;\n        var l = function() {\n          var s = d.createElement('script');\n          s.type = 'text/javascript';\n          s.async = true;\n          s.src = 'https://widget.intercom.io/widget/' + props.app_id;\n          var x = d.getElementsByTagName('script')[0];\n          x.parentNode && x.parentNode.insertBefore(s, x);\n        };\n        if (document.readyState === 'complete') {\n          l();\n        } else if (w.attachEvent) {\n          w.attachEvent('onload', l);\n        } else {\n          w.addEventListener('load', l, false);\n        }\n      }\n    })();\n\n    return () => {\n      IntercomAPI('shutdown');\n      delete window.Intercom;\n      delete window.intercomSettings;\n    };\n  }, []);\n\n  const lastUser = useRef(props.user_id || props.email);\n  useEffect(() => {\n    if (lastUser.current) {\n      // If the user was previously logged in, shut down and start over\n      IntercomAPI('shutdown');\n      IntercomAPI('boot', { ...props });\n    } else if (props.user_id || props.email) {\n      // If the user was not logged in, just call 'update' to let Intercom know\n      IntercomAPI('update');\n    }\n\n    lastUser.current = props.user_id || props.email;\n  }, [props.user_id, props.email]);\n\n  return null;\n}\n\nexport { ReactIntercom, IntercomAPI };\n"],"names":[],"mappings":"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"}